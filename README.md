# Проектная работа "Веб—ларек"
## 1. Используемый стек и структура 

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
— src/ — исходные файлы проекта
— src/components/ — папка с JS компонентами
— src/components/base/ — папка с базовым кодом

Важные файлы:
— src/pages/index.html — HTML—файл главной страницы
— src/types/index.ts — файл с типами
— src/index.ts — точка входа приложения
— src/scss/styles.scss — корневой файл стилей
— src/utils/constants.ts — файл с константами
— src/utils/utils.ts — файл с утилитами

## 2. Функциональные требования к приложению
```
Главная страница содержит каталог товаров, при нажатии на карточку товара открывается модальное окно с детальной информацией о товаре, при нажатии на иконку корзины открывается корзина.
При просмотре конкретного товара показана детальная информация о товаре, при нажатии на кнопку «Купить» товар добавляется в корзину, если не был добавлен в корзину раньше, при нажатии на кнопку «Убрать» товар удаляется из корзины.
Оформление товара:
Первый шаг:
— выбор способа оплаты;
— ввод адреса доставки;
— если адрес доставки не введён, появляется сообщение об ошибке.
Второй шаг:
— ввод почты и телефона покупателя;
— если одно из полей не заполнено, появляется сообщение об ошибке;
— при нажатии на кнопку оплаты появляется сообщение об успешной оплате и товары удаляются из корзины.
Модальные окна закрываются по клику вне модального окна и по клику на иконку «Закрыть» (крестик).
Кнопка перехода к следующему шагу становится доступна только после выполнения действий на текущей странице (выбора товара, способа оплаты, заполнения данных о покупателе).
```

## 3. Инструкция по сборке и запуску

### Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## 4. Описание базовых классов, их предназначение и функции.

### Описание базовых классов: 

#### Класс Api

Основная функция: взаимодействие с API. 
Путь: .\src\components\base\api.ts
Методы:
get — выполняет GET запрос к указанному URI, возвращает Promise с данными;
post — выполняет POST запрос к указанному URI и HTTP—методом.

#### Класс Component

Основная функция: отвечает за работу событий в системе, за их отправку и обработку.
Путь: .\src\components\base\events.ts
Методы:
on — устанавливает обработчик callback на событие;
emit — инициализирует событие;
trigger — создает функцию, которая генерирует событие.

#### Класс Component

Основная функция: обеспечивает базовые инструменты и шаблон для создания компонентов, которые работают с DOM—элементами.
Путь: .\src\components\base\component.ts
Методы:
toggleClass — переключает указанный CSS—класс у элемента, если force задан — добавляет или удаляет класс в соответствии с его значением;
setText — устанавливает текстовое содержимое элемента, значение приводится к строке;
setDisabled — управляет состоянием блокировки элемента, если true, добавляет атрибут disabled; если false, удаляет его.
setHidden — скрывает элемент;
setVisible — делает элемент видимым;
setImage — устанавливает источник изображения (src) и альтернативный текст (alt) для <img> элемента;
render — обновляет свойства компонента данными и возвращает корневой DOM—элемент компонента.

#### Класс Model

Основная функция: обеспечивает базовую модель данных, которая позволяет хранить данные и уведомлять об их изменениях.
Путь: .\src\components\base\model.ts
Методы:
emitChanges — уведомляет всех подписанных слушателей о том, что модель изменилась.

## 4. Описание компонентов, их функций и связей с другими компонентами

Приложение разработано на основе MVP—архитектуры. 

MVP (Model—View—Presenter) — это архитектурный паттерн, который разделяет приложение на три основные компоненты:

Model (Модель): отвечает за бизнес—логику и работу с данными. Это могут быть классы или интерфейсы, реализующие работу с данными, API, базой данных и т.п.

View (Представление): отвечает за отображение данных пользователю и обработку пользовательских событий. DOM—элементы, компоненты UI.

Presenter (Презентер): посредник между Model и View. Он получает пользовательские события из View, обрабатывает их, взаимодействует с Model для получения или изменения данных и обновляет View.

### Model (Модель)

#### CatalogItem
```
Поля: 
id: string — уникальный идентификатор товара;
description: string — описание товара;
image: string — ссылка на изображение;
title: string — название товара;
category: string — категория товара;
price: number | null — цена товара;
inBasket: boolean — есть ли товар в корзине;
Методы:
get categoryClass(): string — возвращает CSS-класс на основе категории.
```
#### Класс App
```
Поля:
items: CatalogItem[] — список товаров каталога;
cart: TCartPopup — корзина с массивом ID товаров и общей ценой;
preview: string | null — ID выбранного товара для предварительного просмотра;
order: TOrder — текущий заказ с контактами, оплатой, адресом, списком товаров и ценой;
formErrors: FormErrors — ошибки формы заказа и контактов;
Методы: 
setCatalog — устанавливает список товаров в каталог;
setPreview — устанавливает выбранный товар для предварительного просмотра;
addToCart — добавляет товар в корзину по его ID, если его там ещё нет;
removeFromCart — удаляет товар из корзины;
removeFromCard — удаляет товар везде;
setOrderField — устанавливает значение поля заказа;
setContactsField — устанавливает контактные данные;
setOrderData — переносит товары из корзины в заказ;
setOrderPayment — устанавливает метод оплаты;
validateOrder — проверяет валидность;
validateContacts — проверяет валидность;
clearCart — очищает корзину.
```

### View (Представление) 

#### Класс Page
```
Функция: расставляет элементы в предназначенные для них контейнеры, отображает количество товаров в корзине;
Поля:
pageContainer: HTMLElement — основной контейнер страницы;
catalogCart: HTMLElement — ссылка на DOM—элемент, отображающий количество товаров в корзине;
productGallery: HTMLElement — ссылка на DOM—элемент, содержащий галерею товаров на странице;
counterCart: HTMLElement — счетчик товаров в корзине;
buttonCart: HTMLButtonElement — кнопка корзины;
Методы: 
updateCartCounter — обновление счетчика корзины;
handleCartClick — обработчик клика по корзине.
```
#### Класс Card
```
Функция: Отображает данные карточки: полное описание, цену, изображение и кнопки КУПИТЬ и УДАЛИТЬ (крестик)
Поля:
cardContainer: HTMLElement — контейнер карточки;
cardTitle: HTMLElement — название товара;
cardDescription: HTMLElement — описание товара;
cardPrice: HTMLElement — цена товара;
cardImage: HTMLImageElement — изображение товара;
Методы:
setText — обновляет текстовое содержимое переданного DOM—элемента;
setImage — Устанавливает изображение в элемент <img>;
setDisabled — Включает или отключает кнопку;
toggleClass — Добавляет или удаляет CSS класс у элемента.

```
#### Класс Cart
```
Функция: Отвечает за содержимое в корзине.
Поля:
cartContainer: HTMLElement — контейнер для перечня товаров;
cartButton: HTMLButtonElement — кнопка оформления заказа;
cartPrice — общая стоимость;
Методы: 
set items — обновляет содержимое списка товаров в корзине;
set total — обновляет отображаемую сумму товаров в корзине;
set toggleButton — управляет состоянием кнопки оформления заказа.

```
#### Класс Popup 
```
Функция: Отображает попапы.
Поля: 
popupContainer: HTMLElement — контейнер для попапа;
popupContent: HTMLElement — элемент для содержимого попапа;
closeButton: HTMLButtonElement — кнопка ЗАКРЫТЬ (крестик);
Методы: 
open — открытие попапа;
close — закрытие попапа;
render — отображение попапа;
set content — заменяет содержимое _content на переданный элемент;
togglePopup — добавляет или удаляет класс 'modal_active', показывая или скрывая попап;
```
#### Класс Form
```
Функция: Отображает форму
Поля: 
protected _submit: HTMLButtonElement — ссылка на кнопку отправки формы;
protected _errors: HTMLElement — для отображения ошибок формы;
constructor: HTMLFormElement — конструктор, инициализирующий поля и устанавливающий обработчики событий формы;
Методы: 
protected onInputChange — вызывается при изменении любого поля формы;
set valid — проверка валидности; 
set errors — отображение ошибок;
render — обновление состояния формы.
```
#### Класс FormContact
```
Функция: Отображает форму с контактными данными.
Поля: 
container: HTMLFormElement — внутри него находятся поля и элементы управления;
events — объект для работы с событиями;
Методы: 
set phone — установка значения поля phone;
set email — установка значения поля email.
```
#### Класс Success
```
Функция: Отображает заказчику, что заказ успешно офорлмлен.
Поля:
price: HTMLElement — будет выводиться сообщение о списании синапсов (списано ...); 
closeButton: HTMLButtonElement — кнопка ЗАКРЫТЬ (крестик);
Методы: 
set price — устанавливает текстовое сообщение о списании синапсов;
```
#### Класс FormPrice
```
Функция: управляет формой с отплатой заказа и адресом
Поля:
typeCash: HTMLButtonElement —  кнопка для выбора оплаты наличными;
typeCard: HTMLButtonElement — кнопка для выбора оплаты картой; 
Методы: 
set address — устанавливает значение адреса;
set payment — устанавливает выбор оплаты.

```
### Presenter (Презентер)

К основным функциям презертера относятся:
— обработка пользовательских событий:
презентер слушает события, исходящие от View;
— взаимодействие с моделью: он вызывает методы модели для получения или изменения данных.
— обновление View:
После получения данных или выполнения логики, презентер обновляет интерфейс через методы View;

Весь код, связанный с бизнес—правилами и обработкой данных, находится внутри презентера, путь файла: .\src\index.ts.
